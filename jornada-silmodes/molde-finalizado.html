<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhes do Molde MP-001 | Simoldes Tools</title>
    <link rel="stylesheet" href="CSS/style.css">
    <link rel="stylesheet" href="CSS/style-DM.css">
</head>
<body>
    <header>
        <a href="index.html">
            <img src="IMG/logo.png" alt="Logo Simoldes" class="logo">
        </a>
        <nav>
            <!-- Menu de navega√ß√£o similar ao index.html -->
        </nav>
    </header>

    <main class="detail-container">
        <div class="breadcrumb">
            <a href="index.html">Home</a> > 
            <a href="index.html">Moldes em Produ√ß√£o</a> > 
            <span>1678</span>
        </div>

        <div class="molde-header">
            <h1>Molde 1678</h1>
            <div class="status-badge em-producao">Em Produ√ß√£o</div>
        </div>

        <div class="detail-grid">
            <!-- Se√ß√£o 1: Informa√ß√µes B√°sicas -->
            <section class="card basic-info">
                <h2>Informa√ß√µes B√°sicas</h2>
                <div class="editable-field">
                    <label>Cliente:</label>
                    <span class="value">Ind√∫stria ABC</span>
                    <button class="edit-btn">Editar</button>
                </div>
                <div class="editable-field">
                    <label>Data In√≠cio:</label>
                    <span class="value">15/03/2023</span>
                    <button class="edit-btn">Editar</button>
                </div>
                <div class="editable-field">
                    <label>Previs√£o Entrega:</label>
                    <span class="value">30/04/2023</span>
                    <button class="edit-btn">Editar</button>
                </div>
                <div class="editable-field">
                    <label>Respons√°vel:</label>
                    <span class="value">Eng. Carlos Silva</span>
                    <button class="edit-btn">Editar</button>
                </div>
            </section>

            <!-- Se√ß√£o 3: Etapas de Produ√ß√£o -->
            <section class="card etapas">
                <h2>Etapas de Produ√ß√£o</h2>
                <div class="timeline">
                    <div class="etapa completed">
                        <div class="etapa-header">
                            <span class="etapa-nome">Projeto 3D</span>
                            <span class="etapa-status">Conclu√≠do</span>
                        </div>
                        <div class="etapa-info">
                            <span>Respons√°vel: Equipe CAD</span>
                            <span>Conclus√£o: 10/03/2023</span>
                            <button class="view-file-btn">Ver Arquivo</button>
                        </div>
                    </div>
                    <div class="etapa in-progress">
                        <div class="etapa-header">
                            <span class="etapa-nome">Usinagem</span>
                            <span class="etapa-status">Em Andamento</span>
                        </div>
                        <div class="etapa-info">
                            <span>Respons√°vel: M√°quina CNC-5</span>
                            <span>Previs√£o: 25/03/2023</span>
                            <button class="update-btn">Atualizar</button>
                        </div>
                    </div>
                    <div class="etapa pending">
                        <div class="etapa-header">
                            <span class="etapa-nome">Montagem</span>
                            <span class="etapa-status">Pendente</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Se√ß√£o 2: Insumos e Materiais -->
            <!-- Substitua a se√ß√£o de Materiais Necess√°rios por este c√≥digo -->
            <section class="card materiais">
                <h2>Materiais Necess√°rios</h2>
                <div class="materials-controls">
                    <button class="add-material-btn" id="add-steel-btn">
                        <span>+</span> Adicionar A√ßo
                    </button>
                    <div class="search-box">
                        <input type="text" id="steel-search" placeholder="Buscar a√ßo...">
                        <button id="search-btn">üîç</button>
                    </div>
                </div>
                
                <div class="table-responsive">
                    <table class="materials-table">
                        <thead>
                            <tr>
                                <th>Tipo de A√ßo</th>
                                <th>C√≥digo</th>
                                <th>Quantidade (kg)</th>
                                <th>Em Estoque</th>
                                <th>Processado</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="steel-list">
                            <tr>
                                <td>A√ßo 1045</td>
                                <td>AC-1045</td>
                                <td><input type="number" value="25" min="0" class="qty-input"></td>
                                <td class="text-center">
                                    <label class="checkbox-container">
                                        <input type="checkbox" checked>
                                        <span class="checkmark"></span>
                                    </label>
                                </td>
                                <td class="text-center">
                                    <label class="checkbox-container">
                                        <input type="checkbox">
                                        <span class="checkmark"></span>
                                    </label>
                                </td>
                                <td class="text-center">
                                    <button class="action-btn" title="Editar">‚úèÔ∏è</button>
                                    <button class="action-btn" title="Remover">üóëÔ∏è</button>
                                </td>
                            </tr>
                            <tr>
                                <td>A√ßo 4140</td>
                                <td>AC-4140</td>
                                <td><input type="number" value="18" min="0" class="qty-input"></td>
                                <td class="text-center">
                                    <label class="checkbox-container">
                                        <input type="checkbox">
                                        <span class="checkmark"></span>
                                    </label>
                                </td>
                                <td class="text-center">
                                    <label class="checkbox-container">
                                        <input type="checkbox" checked>
                                        <span class="checkmark"></span>
                                    </label>
                                </td>
                                <td class="text-center">
                                    <button class="action-btn" title="Editar">‚úèÔ∏è</button>
                                    <button class="action-btn" title="Remover">üóëÔ∏è</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

        </div>

        <!-- Bot√£o de Salvar -->
        <div class="save-container">
            <button class="save-all-btn" id="save-all-data">
                <span class="save-icon">üíæ</span> Salvar Todas as Altera√ß√µes
            </button>
        </div>
        
    </main>

    <footer>
        <p>&copy; 2025 Simoldes Tools. Todos os direitos reservados.</p>
    </footer>

    <script>
        // Fun√ß√£o principal que ser√° executada quando o DOM estiver pronto
        function initPage() {
            // Captura o ID da URL
            const urlParams = new URLSearchParams(window.location.search);
            const moldeId = urlParams.get('id') || "1678"; // Default para exemplo
            
            // Carrega os dados do molde
            const moldeData = carregarDadosMolde(moldeId);
            preencherDados(moldeData);
            
            setupEventListeners();
        }

        // Fun√ß√£o para carregar dados (simulada)
        function carregarDadosMolde(id) {
            // Dados simulados - substitua por chamada real √† API
            return {
                id: id,
                cliente: "Ind√∫stria ABC",
                dataInicio: "15/03/2023",
                previsaoEntrega: "30/04/2023",
                responsavel: "Eng. Carlos Silva",
                materiais: [
                    { nome: "Molde 1678", codigo: "1678", quantidade: "25 kg", status: "disponivel", fornecedor: "Metal√∫rgica XYZ" },
                    { nome: "Molde 1678", codigo: "1678", quantidade: "18 kg", status: "pendente", fornecedor: "Ind√∫stria ABC" }
                ],
                etapas: [
                    { nome: "Projeto 3D", status: "completed", responsavel: "Equipe CAD", conclusao: "10/03/2023" },
                    { nome: "Usinagem", status: "in-progress", responsavel: "M√°quina CNC-5", previsao: "25/03/2023" },
                    { nome: "Montagem", status: "pending" }
                ]
            };
        }

        // Fun√ß√£o para preencher os dados na p√°gina
        function preencherDados(data) {
            document.querySelector('.molde-header h1').textContent = `Molde ${data.id}`;
            
            // Preenche os campos edit√°veis
            const fields = {
                cliente: data.cliente,
                dataInicio: data.dataInicio,
                previsaoEntrega: data.previsaoEntrega,
                responsavel: data.responsavel
            };
            
            Object.keys(fields).forEach((key, index) => {
                document.querySelectorAll('.editable-field .value')[index].textContent = fields[key];
            });
        }

        // Configura todos os event listeners
        function setupEventListeners() {
            // Bot√µes de edi√ß√£o
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', handleEditClick);
            });

            // Bot√£o para adicionar material

            // Bot√£o para salvar valida√ß√µes
            document.querySelector('.save-btn').addEventListener('click', () => {
                const validacoes = {
                    qualidade: document.querySelectorAll('.validation-select')[0].value,
                    engenharia: document.querySelectorAll('.validation-select')[1].value,
                    observacoes: document.querySelectorAll('.validation-notes')[1].value
                };
                console.log('Valida√ß√µes salvas:', validacoes);
                alert('Valida√ß√µes salvas com sucesso!');
            });
        }

        // Manipulador de clique para edi√ß√£o
        function handleEditClick() {
            const field = this.parentElement;
            const valueElement = field.querySelector('.value');
            const currentValue = valueElement.textContent;
            
            const input = document.createElement('input');
            input.type = 'text';
            input.value = currentValue;
            input.className = 'edit-input';
            
            valueElement.replaceWith(input);
            input.focus();
            
            this.textContent = 'Salvar';
            this.classList.add('save-mode');
            
            const saveHandler = () => {
                valueElement.textContent = input.value;
                input.replaceWith(valueElement);
                this.textContent = 'Editar';
                this.classList.remove('save-mode');
                this.onclick = handleEditClick;
                console.log('Valor atualizado:', input.value);
            };
            
            this.onclick = saveHandler;
        }

        // Inicia a p√°gina quando o DOM estiver pronto
        document.addEventListener('DOMContentLoaded', initPage);

        // Modal para adicionar novo a√ßo
        const modal = document.createElement('div');
        modal.className = 'modal';
        modal.innerHTML = `
            <div class="modal-content">
                <span class="close-btn">&times;</span>
                <h3>Adicionar Novo A√ßo</h3>
                <form id="add-steel-form">
                    <div class="form-group">
                        <label for="steel-type">Tipo de A√ßo:</label>
                        <input type="text" id="steel-type" required>
                    </div>
                    <div class="form-group">
                        <label for="steel-code">C√≥digo:</label>
                        <input type="text" id="steel-code" required>
                    </div>
                    <div class="form-group">
                        <label for="steel-qty">Quantidade (kg):</label>
                        <input type="number" id="steel-qty" min="1" value="1" required>
                    </div>
                    <button type="submit" class="submit-btn">Adicionar</button>
                </form>
            </div>
        `;
        document.body.appendChild(modal);

        // Abrir modal
        document.getElementById('add-steel-btn').addEventListener('click', function() {
            modal.style.display = 'block';
        });

        // Fechar modal
        document.querySelector('.close-btn').addEventListener('click', function() {
            modal.style.display = 'none';
        });

        // Adicionar novo a√ßo
        document.getElementById('add-steel-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const type = document.getElementById('steel-type').value;
            const code = document.getElementById('steel-code').value;
            const qty = document.getElementById('steel-qty').value;
            
            // Adiciona √† tabela
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td>${type}</td>
                <td>${code}</td>
                <td><input type="number" value="${qty}" min="0" class="qty-input"></td>
                <td>
                    <label class="checkbox-container">
                        <input type="checkbox">
                        <span class="checkmark"></span>
                    </label>
                </td>
                <td>
                    <label class="checkbox-container">
                        <input type="checkbox">
                        <span class="checkmark"></span>
                    </label>
                </td>
                <td>
                    <button class="delete-btn" title="Remover">üóëÔ∏è</button>
                </td>
            `;
            
            document.getElementById('steel-list').appendChild(newRow);
            
            // Adiciona evento ao bot√£o de deletar
            newRow.querySelector('.delete-btn').addEventListener('click', function() {
                this.closest('tr').remove();
            });
            
            // Limpa o formul√°rio e fecha o modal
            this.reset();
            modal.style.display = 'none';
        });

        // Fun√ß√£o para deletar a√ßos
        document.querySelectorAll('.delete-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                this.closest('tr').remove();
            });
        });

        // Fun√ß√£o de busca
        document.getElementById('search-btn').addEventListener('click', function() {
            const searchTerm = document.getElementById('steel-search').value.toLowerCase();
            const rows = document.querySelectorAll('#steel-list tr');
            
            rows.forEach(row => {
                const steelType = row.cells[0].textContent.toLowerCase();
                const steelCode = row.cells[1].textContent.toLowerCase();
                
                if (steelType.includes(searchTerm) || steelCode.includes(searchTerm)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>